{
    "beforeSaveCustomScript": "name = datetime\\format(datetime\\now(), 'Europe/Kiev', 'DD.MM.YYYY HH:mm');\n\n//add default team\n$defaultTeamId = env\\userAttribute('defaultTeamId');\n$defaultTeamIdList = list($defaultTeamId);\nentity\\addLinkMultipleId('teams', $defaultTeamIdList);",
    "beforeSaveApiScript": "if (!recordService\\skipDuplicateCheck()) {\n    $id = record\\findOne('Mark', null, null, 'abonementId=', abonementId, 'trainingId=', trainingId);\n    \n    if ($id) {\n        recordService\\throwConflict('Абонемент вже відмічений на цьому занятті');\n    }\n}\n\n//Validation if creating via button 'З іншої групи'\nif (isOtherGroup) {\n    //$abonId = record\\findOne('Abonement', null, null, 'id=', abonementId);\n    $abon = record\\fetch('Abonement', abonementId);\n    \n    if (object\\get($abon, 'isActivated') == false) {\n        recordService\\throwForbidden('Абонемент не активованиий');\n    }\n    \n    if (object\\get($abon, 'classesLeft') <= 0) {\n        recordService\\throwForbidden('Абонемент вичерпано');\n    }\n    \n    if (object\\get($abon, 'isFreezed')) {\n        recordService\\throwForbidden('Абонемент заморожено');\n    }\n    \n    /*\n    if (datetime\\diff(object\\get($abon, 'endDate'), datetime\\today(), 'days') < 0) {\n        recordService\\throwForbidden('Абонемент більше не діє');\n    }\n    \n    if (datetime\\diff(object\\get($abon, 'startDate'), datetime\\today(), 'days') >= 0) {\n        recordService\\throwForbidden('Абонемент очікує дати початку');\n    }\n    */\n}"
}