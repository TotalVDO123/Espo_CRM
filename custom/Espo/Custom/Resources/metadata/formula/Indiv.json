{
    "beforeSaveCustomScript": "$typeNames = array\\push($typeNames, 'Індив', 'Дует', 'Трио');\n$clientCount = type;\n\nname = string\\concatenate(hall.number,  '/ ', array\\at($typeNames, $clientCount - 1), ' - ', assignedUser.lastName);\n\nif (isCustomPrice) {\n    price = (cost / 100) * percent;\n} else {\n    //price calculation\n    $categoryId = record\\attribute(\"User\", assignedUserId, 'trainerCategoryId');\n    $categoryIndivId = record\\findOne(\n        'CategoryIndivPrice', 'createdAt', 'desc', \"trainerCategoryId=\", $categoryId, \"clientCount=\", $clientCount\n    );\n    $indivCost = record\\attribute(\"CategoryIndivPrice\", $categoryIndivId, 'price');\n    $indivPercent = record\\attribute(\"CategoryIndivPrice\", $categoryIndivId, 'percent');\n    \n    cost = $indivCost;\n    percent = 100 - $indivPercent;\n    price = ($indivCost / 100) * $indivPercent;\n}"
}