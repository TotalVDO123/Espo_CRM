{
    "beforeSaveCustomScript": "//forwarding\nbranchName = hall.branchName;\n\n$typeNames = array\\push($typeNames, 'Індив', 'Дует', 'Трио');\n$clientCount = array\\length(contactsIds);\n\nif (!isCustomPrice) {\n    name = string\\concatenate(hall.number,  '/ ', array\\at($typeNames, $clientCount - 1));\n    \n    //default price calculation\n    $categoryId = record\\attribute(\"User\", assignedUserId, 'trainerCategoryId');\n    $categoryIndivId = record\\findOne('CategoryIndivPrice', 'createdAt', 'desc', \"trainerCategoryId=\", $categoryId, \"clientCount=\", $clientCount);\n    $indivPrice = record\\attribute(\"CategoryIndivPrice\", $categoryIndivId, 'price');\n    $indivPercent = record\\attribute(\"CategoryIndivPrice\", $categoryIndivId, 'percent');\n    \n    price = $indivPrice;\n    percent = 100 - $indivPercent;\n}"
}